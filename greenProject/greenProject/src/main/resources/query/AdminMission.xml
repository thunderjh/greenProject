<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.admin.mission.dao.AdminMissionDAO">

	<select id="missionList" parameterType="mission" resultType="mission">
		select m_no, m_c_name, m_title, id, m_views,to_char(m_date,'YYYY-MM-DD') as m_date, m_p_approval
		from mission
		<where>
			<if test="search=='m_title'">
			<![CDATA[m_title like '%' || #{keyword} || '%']]>
			</if>
			<if test="search=='m_content'">
			<![CDATA[m_content like '%' || #{keyword} || '%']]>
			</if>
			<if test="search=='m_name'">
			<![CDATA[m_name like '%' || #{keyword} || '%']]>
			</if>
		</where>
		order by m_no desc
	</select>
	
	<update id="pointPlus" parameterType="mission">
		update mission 
		set m_p_approval = 'Y', m_point = 500 
		where m_no =#{m_no}
	</update>
	
	<update id="pointCancle" parameterType="mission">
		update mission 
		set m_p_approval = 'N', m_point = null 
		where m_no =#{m_no}
	</update>
</mapper>