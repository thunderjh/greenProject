<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.client.notice.dao.NoticeDao">

	<select id="noticeList" parameterType="notice" resultType="notice">
		SELECT n_num, n_title, n_content, to_char(n_date,'YYYY-MM-DD') as n_date, views, n_img_file
		FROM notice
		ORDER BY n_num desc
	</select>

	<!-- 공지사항 상세 페이지 조회 -->
	<select id="noticeDetail" parameterType="notice" resultType="notice">
		SELECT
				n_num, n_title, n_content, to_char(n_date, 'YYYY-MM-DD') as n_date
		FROM notice
		WHERE n_num = #{n_num}
	</select>
	
	<!-- 전체 레코드 수 조회 -->
	<select id="noticeListCnt"	 parameterType="notice" resultType="int">
		SELECT count(*) FROM notice
		<trim prefix="where (" suffix = ")">
			<include refid="noticeSearch"></include>
		</trim>
	</select>
	
	<sql id="noticeSearch">
		<if test="search=='b_title'">
			<![CDATA[b_title LIKE '%' || #{keyword} || '%']]>
		</if>
		<if test="search=='b_content'">
			<![CDATA[b_content LIKE '%' || #{keyword} || '%']]>
		</if>
	</sql>
</mapper>